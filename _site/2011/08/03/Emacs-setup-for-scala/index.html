<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <link rel="openid.server" href="http://www.myopenid.com/server" />
   <link rel="openid.delegate" href="http://folone.myopenid.com/" />
   <link rel="me" type="text/html" href="http://www.google.com/profiles/folone" />
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <meta http-equiv="Pragma" content="no-cache">
   <title>Emacs setup for scala</title>
   <meta name="author" content="Georgii Leontiev" />
   <link href="http://feeds.feedburner.com/folone/site" rel="alternate" title="folone" type="application/atom+xml" />

   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="/css/syntax.css" type="text/css" />
   
    <style type="text/css">
        .site {
            width: 40em;
        }
    </style>
   

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />

   <!-- Typekit -->
   <script type="text/javascript" src="http://use.typekit.com/jpd0pfm.js"></script>
   <script type="text/javascript">try{Typekit.load();}catch(e){}</script>

   <!-- GA -->
   <script type="text/javascript">
   var _gaq = _gaq || [];
   _gaq.push(['_setAccount', 'UA-2769351-2']);
   _gaq.push(['_trackPageview']);
   (function() {
     var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
     ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
     var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
   })();
   </script>
</head>
<body>

<div class="site">
  <div class="title">
    <a href="/">Home</a>
    <a class="extra" href="http://about.folone.info/">Обо мне</a>
  </div>
  
  <h1>Emacs setup for scala</h1>
<div id="post">
<p><img src="http://1.bp.blogspot.com/_A7vd1oW85hU/Rod-V4fAaxI/AAAAAAAABHw/jIiZMPqiw7U/s320/IMG_2415.JPG" alt="" /></p>
<p>Многие, кто начинает пробовать работать на скале, после того как дойдут до создания чего-то большего, чем джейсон парсер, начинают задаваться вопросом выбора среды разработки. Обычно эти поиски заканчиваются разочарованием: эклипс глючный, идея не умеет выводить типы для всего, сложнее вышеупомянутого джейсон парсера и перекрашивает кучу валидного кода красным, нетбинз тоже оставляет желать лучшего. Я некоторое время тому открыл для себя емакс. Последний год я использовал его исключительно как органайзер и джаббер-клиент. Но когда сменил работу на имеющую отношение к скале и настало время выбрать среду разработки, вспомнил о своём &#8220;джаббер-клиенте&#8221;.</p>
<p>Быстрый гуглёж показал, что существует некий <a href="http://aemon.com/file_dump/ensime_manual.html">ensime-mode</a>. Вопреки устоявшемуся мнению насчёт емакса вообще и его конфигов в частности, установить и начать играться с этой штукой проще простого.</p>
<p>Я пользуюсь emacs starter kit&#8217;ом. Правда, уже не помню, каким именно: на каждом новом компьютере я просто делаю <code>sudo apt-get install emacs</code>, после чего копирую свою забекапленную директорию <code>.emacs.d</code> в <code>~</code>. Если вы ещё не выбрали себе стартер-кит, советую обратить внимание на <a href="https://github.com/zahardzhan/emacs-starter-kit">вот этот</a> (немного о нём <a href="http://zahardzhan.github.com/2010/emacs-starter-kit-the-program.html">там</a>).</p>
<p>Итак, после установки емакса, <a href="http://www.scala-lang.org/node/201">ставим скалу</a>. В директории <code>$SCALA_HOME/misc/scala-tool-support</code> есть директория <code>emacs</code>. Копируем её содержимое в <code>~/.emacs.d/scala-mode</code>. Качаем новенькую версию <a href="https://github.com/aemoncannon/ensime/downloads">ensime-mode</a> и распаковываем её в <code>~/.emacs.d/ensime</code>. Дальше открываем свой <code>custom.el</code> (<code>init.el</code> для тех, кто не пользуется starter-kit&#8217;ами), и добавляем туда следующее:</p>
<div class="highlight"><pre><code class="scheme"><span class="c1">;; Load scala mode</span>
<span class="p">(</span><span class="nf">add-to-list</span> <span class="ss">&#39;load-path</span> <span class="p">(</span><span class="nf">concat</span> <span class="nv">dotfiles-dir</span> <span class="s">&quot;/scala-mode&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="nf">require</span> <span class="ss">&#39;scala-mode-auto</span><span class="p">)</span>

<span class="c1">;; Load ensime mode</span>
<span class="p">(</span><span class="nf">add-to-list</span> <span class="ss">&#39;load-path</span> <span class="p">(</span><span class="nf">concat</span> <span class="nv">dotfiles-dir</span> <span class="s">&quot;/ensime/elisp&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="nf">require</span> <span class="ss">&#39;ensime</span><span class="p">)</span>

<span class="c1">;; This step causes the ensime-mode to be started whenever</span>
<span class="c1">;; scala-mode is started for a buffer.</span>
<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">&#39;scala-mode-hook</span> <span class="ss">&#39;ensime-scala-mode-hook</span><span class="p">)</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">exec-path</span> <span class="p">(</span><span class="nb">append </span><span class="nv">exec-path</span>
	<span class="p">(</span><span class="nb">list </span><span class="s">&quot;/path-to-scala/scala-2.9.0.1/bin&quot;</span> <span class="p">)))</span>
</code></pre>
</div>
<p>Далее импортируем (или создаём новый) проект: выполняем <code>M-x ensime</code> и следуем инструкциям. После того как ензим создал файл описания проекта (<code>.ensime</code>), выполняем <code>M-x ensime</code> ещё раз, указав расположение нашего нового файла, ждём, когда всё подгрузится и стартанёт. Ензим встретит нас чем-то вроде <code>Hacks and glory await!</code>. Теперь можно смело начинать кодить. Автокомплит вызывается TAB&#8217;ом, полный список команд и клавиатурных сокращений &#8212; <a href="http://aemon.com/file_dump/ensime_manual.html#tth_sEc4.11">тут</a>.</p>
<p>К слову, список фраз-приветствий энзима можно посмотреть (и дополнить) в файле <code>ensime.el</code>. Стандартное содержание выглядит следующим образом:</p>
<div class="highlight"><pre><code class="scheme"><span class="c1">;;; Words of encouragement</span>

<span class="p">(</span><span class="nf">defun</span> <span class="nv">ensime-user-first-name</span> <span class="p">()</span>
  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">name</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">string=</span> <span class="p">(</span><span class="nf">user-full-name</span><span class="p">)</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
		  <span class="p">(</span><span class="nf">user-login-name</span><span class="p">)</span>
		<span class="p">(</span><span class="nf">user-full-name</span><span class="p">))))</span>
    <span class="p">(</span><span class="nf">string-match</span> <span class="s">&quot;^[^ ]*&quot;</span> <span class="nv">name</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">capitalize</span> <span class="p">(</span><span class="nf">match-string</span> <span class="mi">0</span> <span class="nv">name</span><span class="p">))))</span>

<span class="p">(</span><span class="nf">defvar</span> <span class="nv">ensime-words-of-encouragement</span>
  <span class="o">`</span><span class="p">(</span><span class="s">&quot;Let the hacking commence!&quot;</span>
    <span class="s">&quot;Hacks and glory await!&quot;</span>
    <span class="s">&quot;Hack and be merry!&quot;</span>
    <span class="s">&quot;May the source be with you!&quot;</span>
    <span class="s">&quot;Death to null!&quot;</span>
    <span class="s">&quot;Find closure!&quot;</span>
    <span class="s">&quot;May the _ be with you.&quot;</span>
    <span class="s">&quot;M-x be_cool&quot;</span>
    <span class="s">&quot;CanBuildFrom[List[Dream], Reality, List[Reality]]&quot;</span>
    <span class="o">,</span><span class="p">(</span><span class="nf">format</span> <span class="s">&quot;%s, this could be the start of a beautiful program.&quot;</span>
	     <span class="p">(</span><span class="nf">ensime-user-first-name</span><span class="p">)))</span>
  <span class="s">&quot;Scientifically-proven optimal words of hackerish encouragement.&quot;</span><span class="p">)</span>

<span class="p">(</span><span class="nf">defun</span> <span class="nv">ensime-random-words-of-encouragement</span> <span class="p">()</span>
  <span class="s">&quot;Return a string of hackerish encouragement.&quot;</span>
  <span class="p">(</span><span class="nb">eval </span><span class="p">(</span><span class="nf">nth</span> <span class="p">(</span><span class="nf">random</span> <span class="p">(</span><span class="nb">length </span><span class="nv">ensime-words-of-encouragement</span><span class="p">))</span>
	     <span class="nv">ensime-words-of-encouragement</span><span class="p">)))</span>
</code></pre>
</div>
<p>Удачи.</p>
</div>
<hr />
<div style="float:right">
	<!-- Place this tag where you want the +1 button to render -->
	<g:plusone size="small"></g:plusone>

	<!-- Place this tag after the last plusone tag -->
	<script type="text/javascript">
	  (function() {
	    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
	    po.src = 'https://apis.google.com/js/plusone.js';
	    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
	  })();
	</script>
</div>

<div id="related">
  <h2>Recent</h2>
  <ul class="posts">
    
      <li><span>21 Sep 2011</span> &raquo; <a href="/2011/09/21/FixedPointCombinator">Небольшая заметка о комбинаторе неподвижной точки на Scala</a></li>
    
      <li><span>04 Aug 2011</span> &raquo; <a href="/2011/08/04/MathematicsDialog">Ещё одно решение задачки про математиков</a></li>
    
      <li><span>01 Aug 2011</span> &raquo; <a href="/2011/08/01/MonadTutorials">Monad Tutorials</a></li>
    
  </ul>
</div>


<div id="disqus_thread"></div>
<script
   type="text/javascript"
   src="http://disqus.com/forums/folone/embed.js">
</script>
<noscript>
  <a href="http://folone.disqus.com/?url=ref">View the discussion thread.</a>
</noscript>
<a href="http://disqus.com" class="dsq-brlink">
  blog comments powered by <span class="logo-disqus">Disqus</span>
</a>


  
  <div class="footer">
    <div class="contact">
      <p>
        George Leontiev<br />
        Scala developer at <a href="http://thenewmotion.com/">TheNewMotion</a><br />
        (λx.folonexgmail.com)@
      </p>
    </div>
    <div class="contact">
      <p>
        <a href="http://github.com/folone/">github.com/folone</a><br />
        <a href="http://twitter.com/folone/">twitter.com/folone</a><br />
        <a href="http://juick.com/folone/">juick.com/folone</a>
      </p>
    </div>
    <div class="rss">
      <a href="http://feeds.feedburner.com/folone/site">
        <img src="/images/rss.png" alt="Subscribe to RSS Feed" />
      </a>
    </div>
  </div>
<div id="cse" style="width: 100%;">Loading</div>
	<script src="http://www.google.com/jsapi" type="text/javascript"></script>
	<script type="text/javascript"> 
	  google.load('search', '1', {language : 'ru'});
	  google.setOnLoadCallback(function() {
	    var customSearchControl = new google.search.CustomSearchControl('010935229799049702273:zzobyr0tp6u');
	    customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
	    customSearchControl.draw('cse');
	  }, true);
	</script>
	<link rel="stylesheet" href="http://www.google.com/cse/style/look/default.css" type="text/css" />
</div>

<a href="http://github.com/folone"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://a248.e.akamai.net/assets.github.com/img/abad93f42020b733148435e2cd92ce15c542d320/687474703a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67" alt="Fork me on GitHub"></a>

</body>
</html>
